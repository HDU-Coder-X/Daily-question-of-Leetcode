# [187. 重复的DNA序列](https://leetcode-cn.com/problems/repeated-dna-sequences/)

# 题目描述：

所有 DNA 都由一系列缩写为 `'A'`，`'C'`，`'G'` 和 `'T'` 的核苷酸组成，例如：`"ACGAATTCCG"`。在研究 DNA 时，识别 DNA 中的重复序列有时会对研究非常有帮助。

编写一个函数来找出所有目标子串，目标子串的长度为 10，且在 DNA 字符串 `s` 中出现次数超过一次。



**示例1 ：**

```
输入：s = "AAAAACCCCCAAAAACCCCCCAAAAAGGGTTT"
输出：["AAAAACCCCC","CCCCCAAAAA"]
```

**示例2 ：**

```
输入：s = "AAAAAAAAAAAAA"
输出：["AAAAAAAAAA"]
```



# 解答：

## JavaScript：


### 方法一：Set+滑动窗口

维护长度为10的滑动窗口，并将窗口中的子串加入`Set`。加入`Set`之前判断`Set`中是否已存在，若存在，放入`res`。最后返回`res`去重后的结果。

```JavaScript
const findRepeatedDnaSequences = s => {
    const len = s.length;
    const res = [];
    // 长度小于等于10，直接返回空数组
    if (len <= 10) return res;
    const set = new Set();
    let i = 0;
    while (i + 9 < len) {
        // 维护长度为10的滑动窗口
        const str = s.slice(i, i + 10);
        // 当前窗口如果set中已经存在，放入res
        if (set.has(str)) res.push(str);
        // 当前窗口加入set
        set.add(str);
        i++;
    }
    // 数组去重
    return [...new Set(res)];
};
```
```Java
class Solution {
    public List<String> findRepeatedDnaSequences(String s) {
        int len = s.length();
        Set<String> set = new HashSet<>();
        List<String> res = new ArrayList<>();
        // 长度小于等于10，直接返回空数组
        if (len <= 10) return res;
        int i = 0;
        while (i + 9 < len) {
        // 维护长度为10的滑动窗口
            String str = s.substring(i, i + 10);
        // 当前窗口如果set中已经存在，放入res
            if (!set.add(str)) res.add(str);
        // 当前窗口加入set
            i++;
        }
    // 数组去重
        return new ArrayList<String>(new HashSet<String>(res));
    }
}
```
### 方法二：Map+滑动窗口

维护长度为10的滑动窗口，并将窗口中的子串加入`Map`并计数。滑动完成后，遍历`Map`，将次数大于1的加入到`res`。

```JavaScript
const findRepeatedDnaSequences = s => {
    const len = s.length;
    const res = [];
    // 长度小于等于10，直接返回空数组
    if (len <= 10) return res;
    const map = new Map();
    let i = 0;
    while (i + 9 < len) {
        // 维护长度为10的滑动窗口
        const str = s.slice(i, i + 10);
        // 放入map计数
        map.set(str, (map.get(str) || 0) + 1);
        i++;
    }
    for (const item of map) {
        // 挑选出次数大于1的
        if (item[1] > 1) res.push(item[0]);
    }
    return res;
};
```
### 方法三 ：滑动窗口 + 二进制状态压缩

由于字符串长度只有10并且字符种类只有4种，4种状态可以用2位二进制表示00,01,10,11，长度为10的字符串可以用20位二进制表示，
滑动窗口中每移动一次，只需将二进制左移两位。
```java
class Solution {
    public List<String> findRepeatedDnaSequences(String s) {
        Map<Integer,Integer> map = new HashMap<>(857);
        List<String> res = new ArrayList<>(857);
		//x表示滑动窗口的状态
        int x = 0;
        for(int i = 0;i < s.length();i++){
            char c = s.charAt(i);
			//每次遍历将x二进制后两位置为00(A),01(C),10(G),11(T)
            if(c == 'A') x |= 0;
            else if(c == 'C') x |= 1;
            else if(c == 'G') x |= 2;
            else x |= 3;
            if(i >= 9){
                Integer y = map.get(x);
				//如果map中不存在就添加并将次数置为1
                if(y == null){
                    map.put(x,1);
				//如果map中存在次数为1的状态添加入结果，并将次数置为2
                }else if(y == 1){
                    res.add(s.substring(i - 9,i + 1));
                    map.put(x,2);
                }
            }
			//x左移两位腾出后两位为下一次状态更新做准备，注意只取后20位。
            x = x << 2 & 0xfffff;
        }
        return res;
    }
}
```
**时间复杂度 ：O(n)**,n为字符串长度
**空间复杂度 ：O(n)**,哈希表使用的空间

